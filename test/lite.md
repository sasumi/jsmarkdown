#LitePHP2.0升级备忘
##LitePHP简介
litephp快速php框架致力于打造一个程序员使用的，快速构建WEB服务的php网络框架。

框架中提供了灵活的API接口处理，框架流程调度等机制，方便开发人员针对实际的业务进行定制化快速开发。

##LitePHP1.0 问题要点
现有LitePHP1.0版本由于基于比较原始的设计思想，在长期的实际业务使用中，逐步暴露出一些缺陷以及编码上的不规范问题，给实际的开发工作带来一些效率问题。

其中比较集中的问题有以下几点：

1. 代码文件命名较为混乱，体现在：
 - 类文件采用驼峰式写法+下划线分隔。 这种方式会让开发者混淆具体单词与框架命名之间的差别。文件命名、目录命名应当尽量遵循PSR-0、PSR-1或PSR-2标准，减少框架对开发者的认知门槛；
 - 文件命名空间映射到目录较为混乱，命名空间规则、类型上没有统一规划；
2. 数据关系模型映射粗糙，未能很好区分出哪些是Filter，哪些是Property，哪些是外部设置扩展属性。导致底层代码在过滤数据、处理数据是分不清楚那些是属于开发人员需要关注的处理，那些是数据库管理人员需要定义的数据限制。
3. 框架代码聚合度过高，外部系统如需要独立使用框架内某些库类文件等，需要跑整个MVC流程来实现。
4. 框架未对外部功能库进行规划管理，无法灵活引入外部类库使用

##LitePHP2.0特性
1. 重构整体Model构成，引入`TableModel`概念，抽离原有的数据库表定义与数据库模型混合的情况
2. 去除核心ORM依赖Filter，新版ORM不依赖Filter进行数据库过滤、校验，所有校验基于TableModel中缺省定义进行校验（开发可以追加相应字段定义）。核心代码不再对数据进行处理。旧版的`trim()`、`intval()`之类的处理都必须在Controller中由开发显式的进行处理。
3. 重新抽象数据库字段定义，增强匿名闭包属性支持
4. 强化CRUD功能，支持列表、快速搜索、更新、详情、删除、修改状态功能。

  ![Alt tup](src/test.png)
5. 增加脚手架工具，用于快速生产`CRUD`模块。
6. 所有类库代码均纳入命名空间管理，包括函数、辅助类库等。
7. 启动脚本精简：

        //注册自动加载库文件
		<?php
		spl_autoload_register(function($className){
			if(strpos($className, LITE_NS.'\\') === 0){
				$file = str_replace(LITE_NS.'\\', LITE_PATH, $className);
				$file = str_replace('\\', DS, $file);
				$file = $file.'.php';
				if(is_file($file)){
					require_once $file;
				}
			}
		});

8. 优化原有系统自带组件库，包含（分页组件、上传组件、`Request`请求组件）

## 升级步骤
1. 复制`litephp/update.php`文件到项目根目录
2. 执行`/php update.php`进行代码升级
3. 使用代码检查工具：code inspect检查代码语法是否全部正确
4. 升级完成！！

##总结
> LitePHP2.0版本相对于1.0版本，更多的是将编码规范化、文档结构科学化方向做了非常多的改进。

LitePHP版本所有源码已经在**GitHub**上部署，需要获取最新版本代码、文档，可以访问 <http://www.github.com/sasumi/litephp>

或联系作者：<sasumi@qq.com>